(function(){app.controller("artistListController",["$scope","$stateParams","ngDialog","artistService","filterService","dictionaryService","API",function(n,t,i,r,u,f,e){var o;n.showFilter=!0;n.artists=[];n.filters=[];n.selectedFilters={};n.ageRangeFilter={};n.queryString="1=1";n.filterSelected=function(n){return n.selectedItem&&n.selectedItem.Value.length>0};n.init=function(i){u.queryFilters().then(function(t){var r,u,f,h,c,o,s;if(n.filters=_.reject(t.Result,function(n){return _.indexOf(e.hideFilters,n.Key)!==-1}),i==="Standard")for(o=n.filters,u=0,h=o.length;u<h;u++)r=o[u],r.Value.unshift({Key:r.Key,Value:""});if(i==="Compact")for(s=n.filters,f=0,c=s.length;f<c;f++)r=s[f],r.Value.unshift({Key:"All",Value:""})});t.path?f.loadData().then(function(){var i;i=o(t.path);r.queryList(i).then(function(t){n.artists=t.Result.ArtistList})}):r.queryList().then(function(t){n.artists=t.Result.ArtistList})};n.search=function(){var f,e,i,o,t,u;for(t="1=1",u=n.filters,e=function(i){i.Key==="Gender"&&i.selectedItem&&(n.selectedFilters.GenderCode=i.selectedItem.Value);i.Key==="Video"&&i.selectedItem&&(n.selectedFilters.HaveVideo=i.selectedItem.Value);i.Key==="Audio"&&i.selectedItem&&(n.selectedFilters.HaveAudio=i.selectedItem.Value);i.Key==="Available"&&i.selectedItem&&(n.selectedFilters.IsAvailable=i.selectedItem.Value);i.Key==="Region"&&i.selectedItem&&(n.selectedFilters.StateID=i.selectedItem.Value);i.Key==="Type"&&i.selectedItem&&(n.selectedFilters.ArtistTypeCodes=i.selectedItem.Value);i.Key==="Age"&&i.selectedItem&&(n.ageRangeFilter=function(n){return n.Age>=i.selectedItem.Value.split("-")[0]&&n.Age<=i.selectedItem.Value.split("-")[1]});i.Key==="Height"&&i.selectedItem&&(t+="&Height="+i.selectedItem.Value.replace("-",":"));i.Key==="Hair"&&i.selectedItem&&(t+="&HairColour="+i.selectedItem.Value);i.Key==="Ethnicity"&&i.selectedItem&&(t+="&Ethnicity="+i.selectedItem.Value);i.Key==="Eye"&&i.selectedItem&&(t+="&EyeColour="+i.selectedItem.Value)},i=0,o=u.length;i<o;i++)f=u[i],e(f);t.length>3&&t!==n.queryString&&(n.queryString=t,r.queryList(n.queryString).then(function(t){n.artists=t.Result.ArtistList}))};n.onSelectFilter=function(t,i){t.selectedItem=i;n.search()};o=function(n){var r,u,f,e,h,t,i,o,c;return i=n.split("/"),t="1=1",e=_.find(i,function(n){return s(n).toUpperCase().include("ARTISTTYPE")}),e&&(h=e.replace(/artisttype_/i,"").replace(/_/g," "),f=_.findWhere(JSON.parse(sessionStorage.getItem("artistTypes")),{Name:h}),f&&(t+="&ArtistType="+f.Code)),c=JSON.parse(sessionStorage.getItem("states")),o=_.find(c,function(n){return _.find(i,function(t){return n.Code.toUpperCase()===t.toUpperCase()})}),o&&(t+="&State="+o.ID),r=_.find(i,function(n){return s(n).toUpperCase().include("AGE")}),r&&(u=r.replace(/age/i,"").replace("-",":"),u&&(t+="&Age="+u)),t}}])}).call(this);
//# sourceMappingURL=artistListController.min.js.map
